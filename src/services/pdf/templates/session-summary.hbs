<!DOCTYPE html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<link href="https://fonts.googleapis.com/css2?family=WindSong&display=swap" rel="stylesheet">
		<style>
			body {
				font-family: Arial, sans-serif;
				font-size: 16px;
				line-height: normal;
				margin: 0;
				box-sizing: border-box;
			}

			h1, h2 {
				text-align: center;
				padding: 0;
				margin: 0;
			}

			h1 {
				font-size: 26px;
			}

			h2 {
				font-size: 22px;
			}

			h3 {
				font-size: 20px;
			}

			.containerImgHeader {
				display: flex;
				justify-content: center;
				align-items: center;
				gap: 60px;
				margin-bottom: 20px;
			}

			.imgHeader {
				max-width: 100%;
				width: fit-content;
				min-height: 80px;
				max-height: 100px;
				object-fit: contain;
				margin: 0;
			}

			.section {
				display: flex;
				flex-direction: column;
				padding-block: 5px;
			}

			.headerSection {
				text-align: left;
				margin-bottom: 10px;

				width: 100%;
				padding-block: 3px;
				background-color: #f4f4f4;
			}

			.headerSectionRelevant {
				width: 100%;
				display: flex;
				justify-content: center;
			}

			.headerSectionRelevant > h2 {
				text-align: center;
				align-self: center;
				margin-block: 20px;

				width: fit-content;
				padding-block: 3px;
				padding-inline: 10px;
				border-radius: 5px;
				border-bottom: 2px solid #000;
			}

			.label {
				font-weight: bold;
			}

			.field {
				display: flex;
				flex-direction: column;
				margin-bottom: 8px;
				gap: 2px;
			}

			.signature {
				width: 100%;
				border-top: 1px solid #ccc;
				padding-top: 20px;
				margin-top: 50px;
			}

			.signature p {
				margin: 0 0 4px 0;
			}

			.signatureLine {
				display: inline-block;
				margin-left: 6px;
				vertical-align: middle;
			}

			.handwritten {
				font-weight: 400;
				font-family: 'WindSong';
				font-style: normal;
				font-size: 28px;
			}

			ul {
				padding-block: 0;
				margin: 0;
			}

			ul > li {
				margin-block: 5px;
			}

			table {
				width: 100%;
				border-collapse: collapse;
				margin-bottom: 10px;
			}

			table td {
				padding-block: 3px;
				border-bottom: 1px solid #eee;
			}

			table td:nth-child(1) {
				width: 40%;
			}

			table td:nth-child(2) {
				width: 60%;
			}

			.richTextContainer figure, img, image {
				max-width: 500px;
				max-height: 500px;
				width: 100%;
				height: auto;
				object-fit: contain;
			}

			p {
				margin: 0;
			}

			a {
				color: #349cfc;
				text-decoration: none;
				overflow-wrap: break-word;
			}
		</style>
	</head>
	<body>
		<div class="containerImgHeader">
			<img src="{{programImageUrl}}" alt="Logo Platform" class="imgHeader" />
			<img src="{{reportHeaderImageUrl}}" alt="Logo Report Header" class="imgHeader" />
		</div>
		<h1>ACTA DE SESIÓN DE ACOMPAÑAMIENTO</h1>
		<h2>{{programName}}</h2>

		<div class="headerSectionRelevant">
			<h2>{{stitle}}</h2>
		</div>

		<div class="section richTextContainer">
			<h3 class="headerSection">Datos de la Empresa</h3>
			<table>
				<tr>
					<td><span class="label">Razón social:</span></td>
					<td><span class="value">{{bSocialReason}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Teléfono:</span></td>
					<td><span class="value">{{bPhone}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Correo electrónico:</span></td>
					<td><span class="value">{{bEmail}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Sectores económicos:</span></td>
					<td><span class="value">{{bEconomicActivity}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Tamaño:</span></td>
					<td><span class="value">{{bBusinessSize}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Facebook:</span></td>
					<td>
						{{#if (eq bFacebook "No registra.")}}
							<span class="value">{{bFacebook}}</span>
						{{else}}
							<a href="{{bFacebook}}" class="value">{{bFacebook}}</a>
						{{/if}}
					</td>
				</tr>
				<tr>
					<td><span class="label">Instagram:</span></td>
					<td>
						{{#if (eq bInstagram "No registra.")}}
							<span class="value">{{bInstagram}}</span>
						{{else}}
							<a href="{{bInstagram}}" class="value">{{bInstagram}}</a>
						{{/if}}
					</td>
				</tr>
				<tr>
					<td><span class="label">Twitter / X:</span></td>
					<td>
						{{#if (eq bTwitter "No registra.")}}
							<span class="value">{{bTwitter}}</span>
						{{else}}
							<a href="{{bTwitter}}" class="value">{{bTwitter}}</a>
						{{/if}}
					</td>
				</tr>
				<tr>
					<td><span class="label">Sitio web:</span></td>
					<td>
						{{#if (eq bWebsite "No registra.")}}
							<span class="value">{{bWebsite}}</span>
						{{else}}
							<a href="{{bWebsite}}" class="value">{{bWebsite}}</a>
						{{/if}}
					</td>
				</tr>
			</table>
		</div>

		<div class="section richTextContainer">
			<h3 class="headerSection">Datos de Acompañamiento</h3>
			<table>
				<tr>
					<td><span class="label">Áreas de fortalecimiento:</span></td>
					<td><span class="value">{{aStrengtheningArea}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Horas asignadas:</span></td>
					<td><span class="value">{{aTotalHours}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Horas ejecutadas en la sesión:</span></td>
					<td><span class="value">{{aRegisteredHours}}</span></td>
				</tr>
			</table>
		</div>

		<div class="section richTextContainer">
			<h3 class="headerSection">Datos de {{eType}}</h3>
			<table>
				<tr>
					<td><span class="label">Nombre:</span></td>
					<td><span class="value">{{eName}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Correo electrónico:</span></td>
					<td><span class="value">{{eEmail}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Teléfono:</span></td>
					<td><span class="value">{{ePhone}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Perfil:</span></td>
					<td><span class="value">{{{sanitizeHtmlPdf eProfile}}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Áreas de experiencia:</span></td>
					<td><span class="value">{{eStrengtheningArea}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Nivel de educación:</span></td>
					<td><span class="value">{{eEducationLevel}}</span></td>
				</tr>
				<tr>
					<td><span class="label">Total de horas asignadas:</span></td>
					<td><span class="value">{{aTotalHours}}</span></td>
				</tr>
			</table>
		</div>

		<div class="section richTextContainer">
			<h3 class="headerSection">Datos de la Sesión</h3>

			<div class="field">
				<span class="label">Notas de preparación:</span>
				{{{sanitizeHtmlPdf sPreparationNotes}}}
			</div>
			<div class="field">
				<span class="label">Archivos preparatorios:</span>
				{{#if sPreparationFiles.length}}
					<ul>
						{{#each sPreparationFiles}}
							<li><a href="{{this.filePath}}">{{this.name}}</a></li>
						{{/each}}
					</ul>
				{{else}}
					<span>No se adjuntaron archivos.</span>
				{{/if}}
			</div>
			<div class="field">
				<span class="label">Notas:</span>
				{{{sanitizeHtmlPdf sSessionNotes}}}
			</div>
			<div class="field">
				<span class="label">Conclusiones y/o compromisos:</span>
				{{{sanitizeHtmlPdf sConclusionsCommitments}}}
			</div>
			<div class="field">
				<span class="label">Archivos adjuntos:</span>
				{{#if sAttachments.length}}
					<ul>
						{{#each sAttachments}}
							<li><a href="{{this.filePath}}">{{this.name}}</a></li>
						{{/each}}
					</ul>
				{{else}}
					<span>No se adjuntaron archivos.</span>
				{{/if}}
			</div>
		</div>

		{{#if sSessionActivities.length}}
		<div class="section richTextContainer">
			<h3 class="headerSection">Actividades de la Sesión</h3>
			{{#each sSessionActivities}}
				<div style="margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 5px;">
					<h4 style="margin: 0 0 10px 0; color: #1e3a8a; font-size: 18px;">{{this.title}}</h4>
					
					<div class="field">
						<span class="label">Descripción:</span>
						{{{sanitizeHtmlPdf this.description}}}
					</div>
					
					<div class="field">
						<span class="label">Requiere entregable:</span>
						<span>{{this.requiresDeliverable}}</span>
					</div>
					
					<div class="field">
						<span class="label">Fecha límite:</span>
						<span>{{this.dueDatetime}}</span>
					</div>
					
					{{#if this.attachmentPath}}
					<div class="field">
						<span class="label">Archivo adjunto:</span>
						<a href="{{this.attachmentPath}}">Ver archivo</a>
					</div>
					{{/if}}
					
					{{#if this.responses.length}}
					<div class="field">
						<span class="label">Respuestas:</span>
						{{#each this.responses}}
							<div style="margin: 10px 0; padding: 10px; background-color: #f9f9f9; border-left: 3px solid #1e3a8a;">
								<div style="font-size: 12px; color: #666; margin-bottom: 5px;">{{this.createdAt}}</div>
								{{{sanitizeHtmlPdf this.message}}}
								{{#if this.attachmentPath}}
								<div style="margin-top: 5px;">
									<a href="{{this.attachmentPath}}">Ver archivo adjunto</a>
								</div>
								{{/if}}
							</div>
						{{/each}}
					</div>
					{{/if}}
				</div>
			{{/each}}
		</div>
		{{/if}}

		<div class="signature">
			<p>
				<strong>Firma:</strong>
				<span class="signatureLine">
					{{#if sign}}
						<span class="handwritten">{{signature}}</span>
					{{else}}
						<span>________________________________</span>
					{{/if}}
				</span>
			</p>

			<p><strong>Fecha de firma:</strong> {{signedDate}}</p>
			<p><strong>Estado del acta:</strong> {{state}}</p>
			<p><strong>Fecha de generación del acta:</strong> {{generationDate}}</p>
		</div>
	</body>
</html>
